p8131\_hw4\_jsg2145
================
Jared Garfinkel
2/20/2020

``` r
df_low = tibble(
  conx = rep(c("low", "high"), 3),
  hous_tp = rep(c("tr_bk", "apt", "hous"), each = 2),
  values = c(65, 34, 130, 141, 67, 130)
) %>% 
  mutate(sat = "low")

df_med = tibble(
  conx = rep(c("low", "high"), 3),
  hous_tp = rep(c("tr_bk", "apt", "hous"), each = 2),
  values = c(54, 47, 76, 116, 48, 105)
) %>% 
  mutate(sat = "med")

df_high = tibble(
  conx = rep(c("low", "high"), 3),
  hous_tp = rep(c("tr_bk", "apt", "hous"), each = 2),
  values = c(100, 100, 111, 191, 62, 104)
) %>% 
  mutate(sat = "high")

df_tidy = union(df_low, df_med) %>% 
  union(df_high) %>% 
  unnest()

df_tbl = df_tidy %>% 
  pivot_wider(names_from = sat, values_from = values) %>% 
  group_by(conx, hous_tp) %>% 
  mutate(n = sum(low, med, high)) %>% 
  summarize(low_pct = round(low/n*100, digits = 0),
            med_pct = round(med/n*100, digits = 0),
            high_pct = round(high/n*100, digits = 0)
  ) %>% 
  group_by(conx, hous_tp) %>% 
  mutate(total = sum(low_pct, med_pct, high_pct))
```

``` r
df_tbl %>% knitr::kable()
```

| conx | hous\_tp | low\_pct | med\_pct | high\_pct | total |
| :--- | :------- | -------: | -------: | --------: | ----: |
| high | apt      |       31 |       26 |        43 |   100 |
| high | hous     |       38 |       31 |        31 |   100 |
| high | tr\_bk   |       19 |       26 |        55 |   100 |
| low  | apt      |       41 |       24 |        35 |   100 |
| low  | hous     |       38 |       27 |        35 |   100 |
| low  | tr\_bk   |       30 |       25 |        46 |   101 |

``` r
df_tidy_tbl = df_tbl %>% 
  select(-total) %>% 
  pivot_longer(cols = c(low_pct, med_pct, high_pct), names_to = "sat", values_to = "pct") %>% 
  ungroup() %>% 
  mutate(sat = str_remove(sat, "_pct$"),
         sat = factor(sat, labels = c("low", "med", "high")),
         conx = factor(conx, labels = c("low", "high")))  
```

``` r
df_tidy_tbl %>% 
  ggplot(aes(x = sat, y = pct)) +
  geom_col() +
  scale_fill_brewer(palette = "Blues") +
  facet_grid(hous_tp~conx)
```

<img src="p8131_hw4_jsg2145_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />
